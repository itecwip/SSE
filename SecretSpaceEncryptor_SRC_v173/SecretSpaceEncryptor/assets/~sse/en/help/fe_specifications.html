<!doctype html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	
	<title>S.S.E. File Encryptor - Format Specifications</title>
    <script language="JavaScript" src="/android_asset/js/help.js"></script>
	<link rel="stylesheet" type="text/css" href="/android_asset/css/help.css"/>
</head>
<body>
	<h1 id="anchor_main" class="textToCenter smallPad">
		File Encryptor
		<div class="smallerFont">(format specifications)</div>
	</h1>
	
	<img src="../../img/fileenc_format_v2.svg" style="width:500px; max-width: 100%;" alt="SVG support is needed to view this image"/>
	<br/><br/>
	<b>*A - Compression: </b>Zip64 archive. CRC32 for each file within the archive.<br/>
	<b>*B - Encryption: </b>Chosen algorithm in CBC mode. Padding ISO10126-2.<br/>
	<b>*C - Random data block: </b>Random characters, "a-z" and "0-9" only, level 1 authentication - password verification.<br/>
	<b>*D - Random data block: </b>Copy of the *C.<br/>
	<b>*E - Version: </b>Current version 2.<br/>
	<b>*F - Algorithm Codes: </b><br/>
	<div style="margin-left: 1.35em;">
		• 0 = AES (256 bit)<br/> 
		• 1 = RC6 (256 bit)<br/>
		• 2 = Serpent (256 bit)<br/>
		• 3 = Blowfish (256 bit)<br/> 
		• 4 = Twofish (256 bit)<br/>
		• 5 = GOST28147 (256 bit)<br/>
		• 6 = Blowfish (448 bit)<br/>
		• 7 = Threefish (1024 bit)<br/>
		• 8 = SHACAL-2 (512 bit)
	</div>	
	<b>*G - Reserve: </b>1B - not used in the current version.<br/>
	<br/>
	<h2>Key Derivation Function</h2>
	A new key/IV pair is generated by scrypt KDF for every single encryption operation. The pair is derived from Skein-1024 hash of a password using a random salt.
	<br/><br/>
	<b>Scrypt Parameters:</b><br/>
	N = 2048<br/>
    r = 8<br/>
    p = 10<br/>
	<br/><br/>
	<h2>Future (Version 3) Draft Notes</h2>	
	<ul>
		<li>Random access (archive browsing, only selected files for decryption);</li>
		<li>CTR mode probably;</li>
		<li>BLAKE2(sp) integrity check for each file;</li>
		<li>NeoScrypt as KDF;</li>
	</ul>
	<br/>

</body>
</html>
